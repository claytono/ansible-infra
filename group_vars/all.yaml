ec2_region: us-east-1
falcon_eip: 50.16.92.207

prometheus_node_exporter_version: 1.0.1
prometheus_node_exporter_config_flags:
  'collector.textfile.directory': '/var/lib/node_exporter/textfile_collector'
  'web.listen-address': '0.0.0.0:9100'
  'log.level': 'info'

enable_ufw: false

ssh_keys:
  - &jezebel_rsa "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA5XY/Pltocwc8sAZwewrhgInrrDDuw89wJ0I1bx6wR16x650iifiSnIZlD+elk2zyu+AqMwJ74URZgshz02W6HMnFmx6CXfvXC6DmEpSnyY4/WThmP2WyNE/A9nJaLBbBb/LnfJoA+Knb8XzJHWFtpFcNmP9Ltlm1Q9VoFFeCrIG04xmXR4WO2AtTa/Bj0WAPa2whfSiCluFrFLMqqXsXw51Myj6RUahNbQdjwOwFQAwzMEegrEINOKYSlojTyV7mdJ6e3oepf5+3GhttMUVjqFHSxG/HK9WB4xxUaQXdMadNhivJKfHKVFxheW+FWae4WBPV31VHqRQuWrUEEamhUQ== coneill@jezebel"
  - &xtal_ed25519 "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB3URIT9ojo8mqsEjxmFu1C+Bxa3jdcKkUzM++IfDVmu coneill@xtal.oneill.net"

genericusers_users:
 - name: coneill
   comment: "Clayton O'Neill"
   shell: "/bin/bash"
   uid: 10001
   groups: [ 'sudo', 'audio', 'video', 'dialout' ]
   pass: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31623865666436383432373566303765326238656334323163363735393337303064316137313761
          3062646135373935653838663266366631353461643765310a386137626232623131306530333432
          38303866646534353965323037646164353930396531336530316530383566363766393665653235
          3239343735373932350a316632613261323131303734306366383530616562313234313863316631
          31393038366564306164373239616665653330313331396235353462643765376530613863363737
          38303437383831663136633663633337396435366232396535313561363136303665623230386537
          64626363376466336436623262643336336231363432666332623833613232396534626262626561
          34353466356264376663613537653461366265633762653864646239653965346662333534653639
          33366336653833643764626239643039393930313164383930616537396165626535663737346265
          6533666132636666373833653166356133306338343131386431
   ssh_keys:
    - *jezebel_rsa
    - &jezebel_ed25519 "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJCMCD7OnhZIJvdUhHhYGIoH7fN5fWLXHPijB60vp21t coneill@jezebel"
    - *xtal_ed25519
 - name: ansible
   comment: "Ansible role user"
   uid: 9000
   groups: [ 'sudo' ]
   ssh_keys:
    - *jezebel_rsa
    - *jezebel_ed25519
    - *xtal_ed25519

docker_install_compose: false

# relaymail
relaymail_smtp_host: smtp.gmail.com
relaymail_smtp_port: 587
relaymail_smtp_user: clayton.oneill@gmail.com
relaymail_smtp_password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          36356161616463613432643930323363663533336432623133636263636635333634333236353534
          3837326363313663323664373935326366386261653737330a383734313664366236323966366165
          33353738363136643266313162646664333435343239386363323766353737623363616637613339
          6463353564616264650a353837323562646462626537386339393738633336383131316230306361
          36656338616634323135666332363837663061343362343862373939613537323634
relaymail_overwrite_to_target: clayton.oneill@gmail.com

# borgbackup
borgbackup_servers:
  - id: luser
    fqdn: luser.fnord.net
    user: borgbackup
    type: normal
    home: /backups/borg/
    pool: repos
    options: ""

# gross way to stuff more args into create call.
borgbackup_compression: "lz4 --one-file-system"
borgbackup_include:
  - "/"

borgbackup_passphrase: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66633634343430396265343131613131636165656662346264316363353438306266383838363435
          6439343364393136613561616565383232386161373566310a366639313234386363663136666534
          36383736353732366335346235633137633431666431643731363730303534636663633863633566
          3261363735636362310a313933373831383035646630366531363164633464376538393333343364
          61653833383432386630643566306237623964363661396262616330396333353565656338393162
          34353438376466316336613430363337643830303630376239336331366566343063643266376530
          63613030303232353536313434356239323062393333386339393231313639663033323463353530
          31353732313365656563

restic_sftp_client: true
restic_sftp_servers:
  - id: luser
    fqdn: luser.fnord.net
    user: restic
    home: /backups/restic/
    pool: repos

restic_default_config:
  default:
    repository: sftp:restic@luser.fnord.net:/repos/main
    password-file: passphrase.txt

    prometheus-push: "https://pushgateway.k.oneill.net/"
    prometheus-labels:
      - host: '{% raw %}{{ .Hostname }}{% endraw %}'

    run-after-fail: |
        {% raw %}/usr/lib/sendmail clayton@oneill.net <<EOF
        From: clayton@oneill.net
        Subject: {{ .Hostname }} backup failed

        Backup on {{ .Hostname }} failed

        $ERROR_COMMANDLINE failed with exit code $ERROR_EXIT_CODE

        stdout:
        $ERROR

        stderr:
        $ERROR_STDERR
        EOF
        {% endraw %}

    backup:
      #no-error-on-warning: true
      one-file-system: true

      schedule: "*-*-* {{ 23 | random(seed=inventory_hostname) }}:{{ 60 | random(seed=inventory_hostname) }}:00"
      schedule-permission: "system"
      schedule-lock-wait: "23h"

      source:
       - /

    # Configure forget and retention policy so that we'll automatically forget at the end of a backup, but we can also manually forget.
    forget: &forget_config
      keep-daily: 14
      keep-weekly: 12
      keep-monthly: 24
      prune: true

    retention:
      << : *forget_config
      after-backup: true
      host: true

# To be overridden by hosts/groups
restic_config: {}

restic_passphrase: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31386466306334343030376139306166306531353631313537643062613331656665656539303461
          6662643635373737613765363035636461633138366666320a633037653664653530306263663265
          34646366656437323531316133393638326130303138313132623461306563613361656138623237
          6537336363386639310a346139396534316435623162663839656435383363336637353636666462
          39363438663138343135373933663834346465633837333262633433313739353434636564623132
          6637356466643137366133313862373464303037663366323461

tailscale_auth_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          65383664333164383631393034393235353665373966383937313633396338653138666331363535
          3134623931313939383830653239633135653163306331330a653762646566373834346263343662
          66616437333130363738343230396435323030333762356430373138636234626235366139633761
          6263616231346135300a643463646666623563316539353631343866323837636235393439666530
          30626165343537643635393263636131656265303261626362353565636233613030343731373437
          6161636663363834643638643930343264653561663864333964

ler53_account_email: clayton@oneill.net
ler53_aws_access_key: AKIAJKAXEQX5E3OWSFHQ
ler53_aws_secret_key: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33633163656664656635646165613166303161333231613234343866363638373232656564623037
          3864643962383564373737313362303265346436366339610a643230333837626239306463326337
          64656563656164306438663532653133333631303764366435663431646538306161333566643265
          6662653931623334330a363635326363393534616264636338306635326332376266356533306362
          62626664393561396566313162383233643934353062656463303861343935666463383663386134
          3834346332376638396461636662373735316634323333393930
